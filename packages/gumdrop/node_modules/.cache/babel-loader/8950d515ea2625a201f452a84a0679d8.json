{"ast":null,"code":"import _asyncToGenerator from\"/home/haeun/metaplex/js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/haeun/metaplex/js/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/haeun/metaplex/js/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import{Box,Button,CircularProgress,FormControl,InputLabel,Link as HyperLink,MenuItem,Stack,Select,TextField}from'@mui/material';import{useWallet}from'@solana/wallet-adapter-react';import{Keypair}from'@solana/web3.js';import{notify}from'@oyster/common';import{useConnection,Connection}from'../contexts';import{closeGumdrop}from'../utils/claimant';import{explorerLinkFor}from'../utils/transactions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Close=function Close(){var connection=useConnection();var wallet=useWallet();var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),baseKey=_React$useState2[0],setBaseKey=_React$useState2[1];var _React$useState3=React.useState(localStorage.getItem('claimMethod')||'transfer'),_React$useState4=_slicedToArray(_React$useState3,2),claimMethod=_React$useState4[0],setClaimMethod=_React$useState4[1];var _React$useState5=React.useState(localStorage.getItem('mint')||''),_React$useState6=_slicedToArray(_React$useState5,2),mint=_React$useState6[0],setMint=_React$useState6[1];var _React$useState7=React.useState(localStorage.getItem('candyConfig')||''),_React$useState8=_slicedToArray(_React$useState7,2),candyConfig=_React$useState8[0],setCandyConfig=_React$useState8[1];var _React$useState9=React.useState(localStorage.getItem('candyUUID')||''),_React$useState10=_slicedToArray(_React$useState9,2),candyUUID=_React$useState10[0],setCandyUUID=_React$useState10[1];var _React$useState11=React.useState(localStorage.getItem('masterMint')||''),_React$useState12=_slicedToArray(_React$useState11,2),masterMint=_React$useState12[0],setMasterMint=_React$useState12[1];var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var base,instructions,closeResult;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(!wallet.connected||wallet.publicKey===null)){_context.next=3;break;}throw new Error(\"Wallet not connected\");case 3:base=Keypair.fromSecretKey(new Uint8Array(JSON.parse(baseKey)));_context.next=6;return closeGumdrop(connection,wallet.publicKey,base,claimMethod,mint,candyConfig,candyUUID,masterMint);case 6:instructions=_context.sent;_context.next=9;return Connection.sendTransactionWithRetry(connection,wallet,instructions,[base]);case 9:closeResult=_context.sent;console.log(closeResult);if(typeof closeResult==='string'){notify({message:'Close failed',description:closeResult});}else{notify({message:'Close succeeded',description:/*#__PURE__*/_jsx(HyperLink,{href:explorerLinkFor(closeResult.txid,connection),children:\"View transaction on explorer\"})});}case 12:case\"end\":return _context.stop();}}},_callee);}));return function submit(_x){return _ref.apply(this,arguments);};}();var claimData=function claimData(claimMethod){if(claimMethod==='candy'){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(TextField,{id:\"config-text-field\",label:\"Candy Config\",value:candyConfig,onChange:function onChange(e){return setCandyConfig(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{id:\"config-uuid-text-field\",label:\"Candy UUID\",value:candyUUID,onChange:function onChange(e){return setCandyUUID(e.target.value);}})]});}else if(claimMethod==='transfer'){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(TextField,{id:\"mint-text-field\",label:\"Mint\",value:mint,onChange:function onChange(e){return setMint(e.target.value);}})});}else if(claimMethod==='edition'){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(TextField,{id:\"master-mint-text-field\",label:\"Master Mint\",value:masterMint,onChange:function onChange(e){return setMasterMint(e.target.value);}})});}};var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),loading=_React$useState14[0],setLoading=_React$useState14[1];var loadingProgress=function loadingProgress(){return/*#__PURE__*/_jsx(CircularProgress,{size:24,sx:{position:'absolute',top:'50%',left:'50%',marginTop:'-12px',marginLeft:'-12px'}});};return/*#__PURE__*/_jsxs(Stack,{spacing:2,children:[/*#__PURE__*/_jsx(TextField,{id:\"base-text-field\",label:\"Base Private Key\",value:baseKey,onChange:function onChange(e){return setBaseKey(e.target.value);}}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"claim-method-label\",children:\"Claim Method\"}),/*#__PURE__*/_jsxs(Select,{labelId:\"claim-method-label\",id:\"claim-method-select\",value:claimMethod,label:\"Claim Method\",onChange:function onChange(e){localStorage.setItem('claimMethod',e.target.value);setClaimMethod(e.target.value);},style:{textAlign:'left'},children:[/*#__PURE__*/_jsx(MenuItem,{value:'transfer',children:\"Token Transfer\"}),/*#__PURE__*/_jsx(MenuItem,{value:'candy',children:\"Candy Machine\"}),/*#__PURE__*/_jsx(MenuItem,{value:'edition',children:\"Limited Edition\"})]})]}),claimMethod!==''&&claimData(claimMethod),/*#__PURE__*/_jsxs(Box,{sx:{position:'relative'},children:[/*#__PURE__*/_jsx(Button,{disabled:!wallet.connected||!baseKey||loading,variant:\"contained\",style:{width:'100%'},onClick:function onClick(e){setLoading(true);var wrap=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return submit(e);case 3:setLoading(false);_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);notify({message:'Close failed',description:\"\".concat(_context2.t0)});setLoading(false);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function wrap(){return _ref2.apply(this,arguments);};}();wrap();},children:\"Close Gumdrop\"}),loading&&loadingProgress()]})]});};","map":{"version":3,"sources":["/home/haeun/metaplex/js/packages/gumdrop/src/components/Close.tsx"],"names":["React","Box","Button","CircularProgress","FormControl","InputLabel","Link","HyperLink","MenuItem","Stack","Select","TextField","useWallet","Keypair","notify","useConnection","Connection","closeGumdrop","explorerLinkFor","Close","connection","wallet","useState","baseKey","setBaseKey","localStorage","getItem","claimMethod","setClaimMethod","mint","setMint","candyConfig","setCandyConfig","candyUUID","setCandyUUID","masterMint","setMasterMint","submit","e","preventDefault","connected","publicKey","Error","base","fromSecretKey","Uint8Array","JSON","parse","instructions","sendTransactionWithRetry","closeResult","console","log","message","description","txid","claimData","target","value","loading","setLoading","loadingProgress","position","top","left","marginTop","marginLeft","setItem","textAlign","width","wrap"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport {\n  Box,\n  Button,\n  CircularProgress,\n  FormControl,\n  InputLabel,\n  Link as HyperLink,\n  MenuItem,\n  Stack,\n  Select,\n  TextField,\n} from '@mui/material';\n\nimport { useWallet } from '@solana/wallet-adapter-react';\nimport { Keypair } from '@solana/web3.js';\nimport { notify } from '@oyster/common';\n\nimport { useConnection, Connection } from '../contexts';\nimport { closeGumdrop } from '../utils/claimant';\nimport { explorerLinkFor } from '../utils/transactions';\n\nexport const Close = () => {\n  const connection = useConnection();\n  const wallet = useWallet();\n\n  const [baseKey, setBaseKey] = React.useState('');\n  const [claimMethod, setClaimMethod] = React.useState(\n    localStorage.getItem('claimMethod') || 'transfer',\n  );\n  const [mint, setMint] = React.useState(localStorage.getItem('mint') || '');\n  const [candyConfig, setCandyConfig] = React.useState(\n    localStorage.getItem('candyConfig') || '',\n  );\n  const [candyUUID, setCandyUUID] = React.useState(\n    localStorage.getItem('candyUUID') || '',\n  );\n  const [masterMint, setMasterMint] = React.useState(\n    localStorage.getItem('masterMint') || '',\n  );\n\n  const submit = async (e: React.SyntheticEvent) => {\n    e.preventDefault();\n\n    if (!wallet.connected || wallet.publicKey === null) {\n      throw new Error(`Wallet not connected`);\n    }\n\n    const base = Keypair.fromSecretKey(new Uint8Array(JSON.parse(baseKey)));\n\n    const instructions = await closeGumdrop(\n      connection,\n      wallet.publicKey,\n      base,\n      claimMethod,\n      mint,\n      candyConfig,\n      candyUUID,\n      masterMint,\n    );\n\n    const closeResult = await Connection.sendTransactionWithRetry(\n      connection,\n      wallet,\n      instructions,\n      [base],\n    );\n\n    console.log(closeResult);\n    if (typeof closeResult === 'string') {\n      notify({\n        message: 'Close failed',\n        description: closeResult,\n      });\n    } else {\n      notify({\n        message: 'Close succeeded',\n        description: (\n          <HyperLink href={explorerLinkFor(closeResult.txid, connection)}>\n            View transaction on explorer\n          </HyperLink>\n        ),\n      });\n    }\n  };\n\n  const claimData = claimMethod => {\n    if (claimMethod === 'candy') {\n      return (\n        <React.Fragment>\n          <TextField\n            id=\"config-text-field\"\n            label=\"Candy Config\"\n            value={candyConfig}\n            onChange={e => setCandyConfig(e.target.value)}\n          />\n          <TextField\n            id=\"config-uuid-text-field\"\n            label=\"Candy UUID\"\n            value={candyUUID}\n            onChange={e => setCandyUUID(e.target.value)}\n          />\n        </React.Fragment>\n      );\n    } else if (claimMethod === 'transfer') {\n      return (\n        <React.Fragment>\n          <TextField\n            id=\"mint-text-field\"\n            label=\"Mint\"\n            value={mint}\n            onChange={e => setMint(e.target.value)}\n          />\n        </React.Fragment>\n      );\n    } else if (claimMethod === 'edition') {\n      return (\n        <React.Fragment>\n          <TextField\n            id=\"master-mint-text-field\"\n            label=\"Master Mint\"\n            value={masterMint}\n            onChange={e => setMasterMint(e.target.value)}\n          />\n        </React.Fragment>\n      );\n    }\n  };\n\n  const [loading, setLoading] = React.useState(false);\n  const loadingProgress = () => (\n    <CircularProgress\n      size={24}\n      sx={{\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n        marginTop: '-12px',\n        marginLeft: '-12px',\n      }}\n    />\n  );\n  return (\n    <Stack spacing={2}>\n      <TextField\n        id=\"base-text-field\"\n        label=\"Base Private Key\"\n        value={baseKey}\n        onChange={e => setBaseKey(e.target.value)}\n      />\n      <FormControl fullWidth>\n        <InputLabel id=\"claim-method-label\">Claim Method</InputLabel>\n        <Select\n          labelId=\"claim-method-label\"\n          id=\"claim-method-select\"\n          value={claimMethod}\n          label=\"Claim Method\"\n          onChange={e => {\n            localStorage.setItem('claimMethod', e.target.value);\n            setClaimMethod(e.target.value);\n          }}\n          style={{ textAlign: 'left' }}\n        >\n          <MenuItem value={'transfer'}>Token Transfer</MenuItem>\n          <MenuItem value={'candy'}>Candy Machine</MenuItem>\n          <MenuItem value={'edition'}>Limited Edition</MenuItem>\n        </Select>\n      </FormControl>\n      {claimMethod !== '' && claimData(claimMethod)}\n      <Box sx={{ position: 'relative' }}>\n        <Button\n          disabled={!wallet.connected || !baseKey || loading}\n          variant=\"contained\"\n          style={{ width: '100%' }}\n          onClick={e => {\n            setLoading(true);\n            const wrap = async () => {\n              try {\n                await submit(e);\n                setLoading(false);\n              } catch (err) {\n                notify({\n                  message: 'Close failed',\n                  description: `${err}`,\n                });\n                setLoading(false);\n              }\n            };\n            wrap();\n          }}\n        >\n          Close Gumdrop\n        </Button>\n        {loading && loadingProgress()}\n      </Box>\n    </Stack>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}